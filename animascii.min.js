/*
 * COPYRIGHT 2018 THEGREATRAMBLER github.com/TheGreatRambler/AnimASCII
 * MIT License
 */
(function(d,a){"function"===typeof define&&define.amd?define(["ROT"],a):"object"===typeof module&&module.exports?module.exports=a(require("ROT")):d.animascii=a(d.ROT)})("undefined"!==typeof self?self:this,function(d){return function(a,g){function m(a,b,e){var f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");f.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a={};this.responseText.split("\n").forEach(function(f){var c=b.find(function(a){return a.symbol===
f.charAt(0)});"undefined"!==typeof c&&(!1===Array.isArray(a[c.name])&&(a[c.name]=[]),a[c.name].push(f.substr(1)))});e(a)}};f.open("GET",a.src,!0);f.send()}function l(a,c,d){var f=c.widthheight[0],n=c.widthheight[1];if(a<d){for(var m=a*n,k=0;k<f;k++)for(var h=0;h<n;h++)e.asciiscreen.draw(k,h,c.frames[m+h][k]);e.stopbool?g&&g():setTimeout(function(){l(++a,c,d)},c.frametime[a])}else-1===b.repeat||e.iteration<b.repeat?(e.iteration++,l(0,c,d)):g&&g()}var p=Array.isArray(a.src),b={};this.iteration=0;var e=
this;this.stopbool=!1;b.repeat="undefined"===typeof a.repeat?1:a.repeat;b.letter_padding="undefined"===typeof a.letter_padding?1:a.letter_padding;b.font_family="undefined"===typeof a.font_family?"monospace":a.font_family;b.font_size="undefined"===typeof a.font_size?25:a.font_size;b.background_color="undefined"===typeof a.background_color?"white":a.background_color;b.foreground_color="undefined"===typeof a.foreground_color?"black":a.foreground_color;b.delay="undefined"===typeof a.delay?200:a.delay;
e.asciiscreen=new d.Display({fontSize:b.font_size,bg:b.background_color,fg:b.foreground_color,fontFamily:b.font_family,spacing:b.letter_padding});d.Display.Rect.cache=!0;a.display.appendChild(this.asciiscreen.getContainer());this.stop=function(){e.stopbool=!0};!1===p?m({src:a.src},[{symbol:"#",name:"widthheight"},{symbol:"^",name:"frametime"},{symbol:"%",name:"frames"},{symbol:"_",name:"comments"},{symbol:"+",name:"name"}],function(a){var b=a.widthheight[1];e.asciiscreen.setOptions({width:a.widthheight[0],
height:b});l(0,a,a.frames.length/b)}):(this.asciiscreen.setOptions({width:a.src[0][0].length,height:a.src[0].length}),l(0,{widthheight:[a.src[0][0].length,a.src[0].length],frametime:Array(a.src.length).fill(b.delay),frames:[].concat.apply([],a.src)},a.src.length))}});
